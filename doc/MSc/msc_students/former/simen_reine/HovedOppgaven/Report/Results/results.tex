\chapter{Results}
\label{Results}

In this chapter we start by testing whether the program code can
reproduce known solutions, and proceed by testing the energy
and variance optimization schemes. Then the results regarding the
atomic problem are presented and estimates of the computational time
dependency with number of particles are exemplified. The next and
final step is to suggest how to increase the efficiency of the code.

%********************* Testing the code *******************
%
%
\section{Testing the code}
\label{TestingTheCode}

Regarding the development of any numerical tool, the first concern is
to test whether the code has been correctly implemented. This
is usually done by considering special cases where the solutions are
already known. 
\newline
%
\newline
The Slater-determinant part of the code is validated by reproduction
of the HF results. This is realized by setting the Jastrow-factor
equal to unity, and using the Roothaan Hartree-Fock wave-functions
optimized by Clementi and Roetti, see ref. \cite{clementi1974}. In table
\ref{HFfNone} the results for some atoms are listed, and these
are in excellent agreement with the HF energies. This indicates that
the Slater determinant part of the code works the way it is supposed
to.
\newline

\begin{table}[hbtp]
\begin{center} {\large \bf Test of VMC Slater determinant} \\ 
$\phantom{a}$ \\
\begin{tabular}{ccccc}
\hline\\ 
$\phantom{AA}${\bf Atom}$\phantom{AA}$ & $\phantom{AA}${\bf HF}$\phantom{AA}$     & $\phantom{AA}${\bf VMC}$\phantom{AA}$    \\
He         &   -2.8617    & -2.8618(1)   \\
Li         &   -7.4327    & -7.4325(11)  \\   
B          &  -24.5290    & -24.534(12)  \\   
C          &  -37.6886    & -37.599(50)  \\   
Ne         &  -128.547    & -128.551(19) \\   
Ar         &  -526.817    & -526.84(15)  \\  [10pt]
\hline
\end{tabular} 
\end{center}
\caption{VMC results for a Roothaan Hartree-Fock wave-function Slater
  determinant, compared with the exact HF results of
  ref. \cite{clementi1974}.}
\label{HFfNone}
\end{table}

The correlation part was tested for a two-particle quantum dot. This
test was performed by a fellow student, ref. \cite{popsueva2004}, and
was in agreement with the analytical solution,
ref. \cite{dineykhan1997}.
\newline
%
\newline
Having tested the two main building blocks of our program, 
we turn our attention to the two different optimization schemes.
Both the energy and the variance optimization schemes are applied
to a few simple helium atom trial wave-functions. When introducing the
variational approach to the helium atom (in section
\ref{TheHeliumAtom}) we started out by a trial wave-function which is
a product of two hydrogen-like $1s$ orbitals, namely 

\begin{equation} 
  \psi_{\alpha} = e^{-\alpha (r_1+r_2)}.
\label{psiAlpha}
\end{equation}

Listed in table \ref{hydrHelium} are the results of the energies
optimized both through energy and variance optimization. Also listed
is the energy for $\alpha = 2$ which is in excellent agreement with
the exact result $-2.75$ (see section \ref{TheHeliumAtom}).
The energy optimization performed to obtain the
optimized result of $\psi_{\alpha}$ is given step by step in figure
\ref{parameterWalkAlpha}. This figure shows how we move from the
initial guess of $\alpha = 2$ and relax to the value $\alpha =
1.5875$. The energy estimate for $\alpha = 1.5875$ is $\langle
E_{\alpha} \rangle = -2.8365 \pm 0.0004$, which is in good, though not
excellent, agreement with the analytical energy minimum $\langle
E_{\alpha} \rangle = -2.85$ for $\alpha = 1.6875$ (see section
\ref{TheHeliumAtom}). In general, the energy optimization scheme
cannot be trusted completely. We will discuss this
shortly, but first we look at an extension to the trial
wave-function $\psi_{\alpha}$.
\newline


\begin{figure}[hbtp]
  \input{Results/parameterWalkAlpha}
  \caption{ Figure illustrating the step-by-step energy optimization
  routine. The plot was made optimizing $\psi_{\alpha}$, given by
  eq.~(\ref{psiAlpha}), with respect to energy.  We start out
  by an initial guess (VMC run number 0) for the parameter $\alpha$
  and move to the lowest energy estimate of the three points
  $\alpha-\delta\alpha, \alpha, \alpha+\delta\alpha$. Here the
  walker is generated by the central wave-function $\psi_{\alpha}$,
  and the energy estimates of the two local variation
  $\psi_{\alpha}-\delta\alpha$ and $\psi_{\alpha}+\delta\alpha$ are
  generated using correlated sampling.  We continue the process 
  until the parameter movement is no longer in the same general
  direction, and then increase the number of cycles and reduce the
  variation $\delta\alpha$ to narrow down the minimum search. This
  process is continued a total of six times; the number of MC cycles
  is increased (from 100 000 to 24 300 000) and the  parameter
  variation reduced (from 0.08 to 0.0025).
  }
  \label{parameterWalkAlpha}
\end{figure}

In Quantum Monte Carlo methods, a common extension to
wave-functions consisting of one-particle
orbitals is to include a Jastrow-factor. We select a
one-parameter Pad\'{e}-Jastrow (introduced in section
\ref{TheTrialWaveFunction}) for a first approximation, and 
now have two parameters $\alpha$ and $\beta$ to optimize,

\begin{equation} 
  \psi_{\alpha,\beta} = e^{-\alpha (r_1+r_2)} 
  exp(\frac{r_{ij}}{2(1 + \beta r_{ij})}).
\label{hydrHeliumJastrow}
\end{equation}

In table \ref{hydrHelium} the results of the two different
optimization schemes to this function are listed. Even though the
wave-function is simple, these results are quite good. By
comparison, the HF result given by ref. \cite{clementi1974}, is
$-2.8617$, and the 'exact' result as given by ref. \cite{hammond1994}
is $-2.9037$.
\newline

\begin{table}[hbtp]
\begin{center} {\large \bf Helium Hydrogenic Trial-Functions} \\ 
$\phantom{a}$ \\
\begin{tabular}{ccccc}
\hline\\ 
{\bf Wave-function} & $\phantom{AA}${\bf $\alpha$}$\phantom{AA}$& $\phantom{AA}${\bf $\beta$}$\phantom{AA}$&$\phantom{AA}${\bf VMC result}  \\
$\psi_{\alpha}$       &       2.0   &              &-2.7504(4)        \\   
$\psi_{\alpha}$       &     1.5875  &              &-2.8365(4)$^{(a)}$\\   
$\psi_{\alpha}$       &     1.9625  &              &-2.7707(4)$^{(b)}$\\   
$\psi_{\alpha,\beta}$ &     1.71    &     0.6625   &-2.8800(2)$^{(a)}$\\
$\psi_{\alpha,\beta}$ &     1.9525  &     0.39     &-2.8778(2)$^{(b)}$\\ [10pt] 
\hline
\end{tabular} 
\end{center}
\caption{VMC energies for He using different two different trial
  wave-functions $\psi_{\alpha}$ and $\psi_{\alpha,\beta} $, given by
  eqs.~(\ref{psiAlpha}) and (\ref{hydrHeliumJastrow}) respectively.
  Two different optimization schemes have been used; (a) energy
  optimization, (b) variance optimization.}
\label{hydrHelium}
\end{table}

Different results are obtained for the two individual optimization
schemes. The trial wave-functions, $\psi_{\alpha}$ and
$\psi_{\alpha,\beta}$, fail to incorporate the electron-nucleus cusp
condition for $\alpha \ne 2$. This results in an energy divergence when
one of the electron-nucleus distances approaches zero. On the other hand,
the electron-electron repulsion shields some of the nucleus
attraction. Therefore, the 'tails' of the orbitals should be
stretched, indicating a lower value of $\alpha$. Lowering $\alpha$
results in larger divergences near the nucleus, but at the same time
it gives a better representation of the wave-function at a distance
from the nucleus. The energy optimization scheme therefore results in
a lower value of $\alpha$ than the variance optimization.
This illustrates some of the differences of the two optimization 
schemes, but a more thorough investigation of the methods are
needed. Two important questions arises; will we arrive at the 
same minimum if we conducted a new search, and do we move towards the
actual minimum?
\newline
%
\newline
The answer to the first question is ambiguous, and is rather put as
a reminder that consistency-tests \emph{should} be provided before any
trust can be put into the results. The optimization routine must be
stable, which means that when applied to different starting points all
must relax to some small confined subspace of the parameter space.
A problem we often encountered was that the variation of the
parameters were small compared to the accuracy of the energy
estimates. Such an approach makes the routine relax to the wrong
parameter set. At the same time, increasing the accuracy requirement
reduces the efficiency of the optimization procedure. Therefore, some
experience is needed for selecting the number of MC cycles, choosing
the parameter step lengths etc. 
\newline
%
\newline
The second question - do we move toward the 'true' minimum - is
essential. The VMC energy optimization routine 
should, given a trial wave-function, find a set of parameters 
that are in the neighbourhood of the true energy minimum. Similarly,
the variance optimization scheme should arrive at a parameter set
near the true variance minimum. Finding a \emph{wrong} parameter set 
\emph{many} times does not make the procedure more correct. 
\newline

\begin{figure}[hbtp]
  \input{Results/parameterWalkHeHydrfBeta.alpha}
  \input{Results/parameterWalkHeHydrfBeta.beta}
  %\input{Results/parameterWalkHeHydrfBeta.energy}
  \caption{Figure illustrating the step by step parameter walk of the
  energy optimization routine. The parameter walk was generated
  by optimizing $\psi_{\alpha,\beta}$, given by 
  eq.~(\ref{hydrHeliumJastrow}), with respect to energy. We start out
  by an initial guess (VMC run number 0) for the parameters
  $(\alpha,\beta)$ and move to 
  the lowest energy estimate on the rectangle specified by the two
  corners $(\alpha-\delta\alpha,\beta-\delta\beta)$ and
  $(\alpha+\delta\alpha,\beta+\delta\beta)$, using correlated
  sampling. We continue the process 
  until the general movement is no longer uni-directional. We then
  increase the number of cycles and reduce the variations
  $\delta\alpha$ and $\delta\beta$. This process is continued a total
  of six times; the number of MC cycles is increased (from 100 000 to
  24 300 000) and the  parameter variation reduced (from 0.08 to
  0.0025).
  }
  \label{parameterWalkHeHydrfBeta}
\end{figure}

The simulation of an energy optimization scheme is given in figure
\ref{parameterWalkHeHydrfBeta}. Here the two parameters of
$\psi_{\alpha,\beta}$, given by eq.~(\ref{hydrHeliumJastrow}) are
optimized. As can be seen from  
figure \ref{parameterWalkHeHydrfBeta} the values of the two parameters
are narrowed down, and they relax to a small confined subspace  of the
parameter space. Unfortunately, the two parameters we obtain do not
represent the energy minimum. In figure \ref{parameterPairEnergies}
accurate energy estimates are given for a few selected parameter pairs
$(\alpha,\beta)$. The pairs have been selected from the parameter pairs
generated by the energy optimization scheme.
\newline

\begin{figure}[hbtp]
  \input{Results/parameterPairEnergies}
  \caption{Accurate estimates of the energies of a few selected
  parameter pairs generated by the energy optimization algorithm for
  $\psi_{\alpha,\beta}$ given by eq.~(\ref{hydrHeliumJastrow}). The
  step by step optimization is depicted in figure
  \ref{parameterWalkHeHydrfBeta}. 
  }
  \label{parameterPairEnergies}
\end{figure}

Figure \ref{parameterPairEnergies} indicates that the energy
minimum is not the one obtained through the energy optimization
routine. The lowest energy in this series is for the parameter pair 
$(\alpha,\beta) = (1.76,0.54)$. In table \ref{energyMinimaCheck}, the
parameter space in the close vicinity of this parameter set is
investigated further.
\newline

\begin{table}[hbtp]
\begin{center} {\large \bf Localizing the Actual Energy Minimum} \\ 
$\phantom{a}$ \\
\begin{tabular}{cccccc}
\hline\\ 
$\alpha \backslash \beta$ & 0.30       & 0.34       & 0.38       & 0.40       & 0.42       \\
1.72                      &            & -2.8762(4) &            &            &            \\
1.76                      & -2.8819(2) & -2.8836(2) & -2.8855(2) &            &            \\
1.80                      &            & -2.8883(1) & -2.8890(2) &            & -2.8893(2) \\
1.82                      &            &            &            & -2.8901(3) &            \\
1.84                      &            &            & -2.8897(3) &            & -2.8896(2) \\ [10pt]    
\hline
\end{tabular} 
\end{center}
\caption{VMC electronic energies for He using different parameter
  settings in the proximity of the minimum energy of figure
  \ref{parameterPairEnergies}.} 
  \label{energyMinimaCheck}
\end{table}

Table \ref{energyMinimaCheck} pinpoints the energy minimum of
$\psi_{\alpha,\beta}$ to be in the
close to $(\alpha,\beta) = (1.82,0.40)$, which is significantly 
different from the result obtained through the energy optimization
scheme (see table \ref{hydrHelium}). These results give a clear
indication that there is something wrong with the energy optimization
procedure. This signifies the importance of using another approach. 
\newline
%
\newline
We now take a look at the variance optimization scheme with weights
set to unity (see section \ref{EnergyAndVarianceOptimization} and
section \ref{CorrelatedSampling}). In figure
\ref{parameterWalkHeHydrfBetaVariance} the variance optimization
procedure for $\psi_{\alpha,\beta}$ is depicted.
\newline

\begin{figure}[hbtp]
  \input{Results/varianceParameterWalk.alpha}
  \input{Results/varianceParameterWalk.beta}
  %\input{Results/varianceParameterWalk.variance}
  \caption{ Figure illustrating the step-by-step parameter walk of the
  variance optimization routine. The plot was made optimizing
  $\psi_{\alpha,\beta}$ given by 
  eq.~(\ref{hydrHeliumJastrow}) with respect to variance.  We start out
  by an initial guess (VMC run number 0) for the parameters
  $(\alpha,\beta)$ and move to the lowest variance estimate on the
  rectangle specified by the two corners
  $(\alpha-\delta\alpha,\beta-\delta\beta)$ and
  $(\alpha+\delta\alpha,\beta+\delta\beta)$, using correlated
  sampling. We continue the process until the general movement in
  parameter space is no longer 
  uni-directional. We then increase the number of cycles and reduce
  the variations $\delta\alpha$ and $\delta\beta$. This process is
  repeated a total of six times; the number of MC cycles is increased
  (from 100 000 to 24 300 000) and the  parameter variation reduced
  (from 0.08 to 0.0025).
  }
  \label{parameterWalkHeHydrfBetaVariance}
\end{figure}

Compared to the energy optimization scheme in figure
\ref{parameterWalkHeHydrfBeta} the variance optimization scheme
pinpoints a parameter minimum with fewer VMC runs. The values of 
table \ref{varianceMinimaCheck} have been created by varying the
parameters in the vicinity of the parameter minimum (obtained through
variance optimization). These values give an indication that the 
parameters representing the variance minimum of $\psi_{\alpha,\beta}$
are in the close proximity of the parameters obtained through
the optimization scheme. However, to
obtain significant results a greater number of estimates are
needed. Nevertheless, this result favors the variance optimization
scheme over the energy optimization scheme. For additional
investigation into the nature of the variance optimization scheme,
consult for example ref.~\cite{kent1999}.
\newline

\begin{table}[hbtp]
\begin{center} {\large \bf Localizing the Actual Variance Minimum} \\ 
$\phantom{a}$ \\
\begin{tabular}{cccccc}
\hline\\ 
$\alpha \backslash \beta$ & 0.37        & 0.39      & 0.41       \\
1.93                      &             & 0.2676(8) &            \\
1.95                      & 0.2641(4)   & 0.2638(5) & 0.2647(5)  \\
1.97                      &             & 0.2692(2) &            \\  [10pt]
\hline
\end{tabular} 
\end{center}
\caption{Averaged Local energy variances for He using four different
  parameter settings in the proximity of the variance minimum obtained
  through the variance optimization procedure depicted in figure
  \ref{parameterWalkHeHydrfBetaVariance}. The five individual points
  were averaged over 1 000 estimates of the (uncorrelated) standard
  error, where each estimate again was created using 100 000 MC
  cycles.}
  \label{varianceMinimaCheck}
\end{table}

The results of this section indicates that the variance optimization
scheme is well suited for optimization, whereas the energy
optimization scheme fails to pinpoint the energy minimum. The minimum
value of table \ref{energyMinimaCheck}, $-2.8901 \pm 0.0003$, compared
to the minimum value obtained through the energy optimization,
$-2.8800 \pm 0.0002$, clearly shows the inaccuracy of the energy
optimization. Still, the 
variance optimization landed at an energy $-2.8778 \pm 0.0002$. This
indicates that, with regard to the optimization of
$\Psi_{\alpha,\beta}$, we loose a significant amount of the obtainable
correlation energy. The actual minimum of $\Psi_{\alpha,\beta}$ is
approximately $30\%$ closer to the 'exact' value $-2.9037$, 
ref. \cite{hammond1994}, than the results obtained through both of the
optimization schemes. For obtaining the best energy both
these methods fail, however, the energy in itself is usually not the
principal result we are looking for. When VMC is used as a starting point
for a DMC calculation, a low variance in the guiding function is
favorable to a low energy. This is due to the reduction of the branching
term of the diffusion equation,
eq.~(\ref{diffusionBrancingDriftEquation}). Furthermore, to
incorporate the cusp conditions the variance optimization provides
the best result (thereby limiting the variance due to the
divergences). Therefore, for most purposes variance optimization is
preferable.


%*********************** Atomic Results *********************
%
%
\section{Atomic Results}
\label{AtomicResults}

In this section we present our results regarding the atomic
problem. All the results presented in this section are generated using
the fixed Roothaan Hartree-Fock determinants combined with variational
electron-electron Pad\'{e}-Jastrow factors. Table
\ref{litiumPadeJastrow} lists the optimized electronic energies for
the lithium atom. 
\newline

\begin{table}[hbtp]
\begin{center} {\large \bf Lithium} \\ 
$\phantom{a}$ \\
\begin{tabular}{ccccc}
\hline\\ 
{\bf \# of parameters} &     {\bf VMC}    & {\bf \% CE} \\
1                     &       -7.4599(2) &  59.9(4) \\   
3                     &       -7.4614(1) &  63.2(3) \\   
5                     &       -7.4622(2) &  65.0(4) \\   [10pt]  
\hline
\end{tabular} 
\end{center}
\caption{VMC results for a Roothaan HF Slater determinant,
  ref. \cite{clementi1974}, multiplied with a one-, three- or
  five-parameter electron-electron Pad\'{e}-Jastrow factor,
  ref. \cite{hammond1994}, for the Li ground state.
  The last column, $\%$ CE, is the difference between the HF
  energy $-7.4327$ and the VMC energy, relative to the difference
  between the HF and the exact $-7.4781$ result, see
  ref. \cite{hammond1994}.}
\label{litiumPadeJastrow}
\end{table}

Three different Pad\'{e}-Jastrow factors have been optimized. These
results indicate that the additional information gained by including
additional terms in the electron-electron part of the Pad\'{e}-Jastrow
factor is small, but still important. 
\newline
%
\newline
Table \ref{atomicResults} lists the optimized electronic energies for
several atoms, where we have optimized a one-parameter Pad\'{e}-Jastrow
factor. As indicated by this table, the effects of 
electron-electron correlations becomes less important with
system size. To obtain even better wave-functions, a
natural extension of the Jastrow factor is to include
effects such as additional electron-nucleus and
electron-electron-nucleus correlations. Adding such particle-particle 
correlations awaits further development. 
\newline
%
\newline
The optimization procedure has
not yet been parallelized and was performed on my 1.4 GHz laptop. The
resulting optimized wave-functions were then used to create the
results of table \ref{atomicResults} by parallel computations on
eighteen machines in the range 0.8-1.4 GHz. The longest run was
argon that lasted approximately 10 hours and 30 minutes. This run
generated  $1.1$ billion MC cycles. In a similar simulation for
carbon, the run lasted about 9 hours and 30 minutes, and $36.3$ billion
MC cycles where created. If we wanted to create the same number
of cycles for argon as for carbon, we would need to run the code

\begin{equation*}
  \frac{36.3\cdot10^9}{1.1\cdot10^9} \frac{10.5}{9.5} \approx 3.65
\end{equation*}

times longer for argon than for carbon. This suggests a dependency,
with the number of electrons $N$, of the order ${\cal
  O}(N^{1.2})$, where the power  $1.2$ is found by taking the ratio $ln
3.65 / ln (18/6) \approx 1.2$. 
\newline
%
\newline
Here each MC sample consists of a move of only one electron. When
compared to moving all electrons at once, the information gained, by
sampling the energies with each individual move, is reduced by an
accuracy of approximately order ${\cal O}(N)$. This is because it
takes the walker at least $N$ 
MC cycles to reach a completely new configuration. Still the
evaluation of all the required wave-function derived quantities is for
this example of order ${\cal O}(N^{2.2})$. When including more
electrons the order ${\cal O}(N^3)$ evaluation of the Slater
determinant will eventually dominate. However, this result shows that
in the range up to $18$ particles we have reduced the order of the
integrand evaluation by approximately a power $0.8$. This reduction is
considerable.
\newline
%
\newline
Our implemented code is very fast, but the efficiency may be greatly
improved. Before we look at ways to improve the efficiency, we give an
estimate of the actual order of the overall efficiency. Still, we look
at the example of argon and carbon. In this 
example, the estimated standard errors were computed to be $s.e._{Ar} =
0.005094$ and $s.e._{C} = 0.0002817$ respectively. If we wanted the
same accuracy for argon as for carbon we would need to to increase the
number of cycles by a factor\footnote{Recall that $s.e. =
  \sigma/\sqrt{M}$, with $M$ the number of sampling points.}

\begin{equation*} 
  \left|\frac{s.e._{Ar}}{s.e._{C}}\right|^2 = 356.
\end{equation*}

In comparison with carbon we would therefore need to run the program
$356\cdot 10.5/9.5 = 403$ times longer. This implies a dependency with
the number of electrons according to

\begin{equation*}
  \left|\frac{18}{6}\right|^p = 403,
\end{equation*}

which leads to $p \approx 5.5$. The program code therefore have an
order ${\cal O}(N^{5.5})$ dependency to obtain a required
accuracy. Furthermore, as indicated by table \ref{atomicResults} the
correlation gained for argon is far less than what was gained for
carbon. Therefore the computational time needed to acquire a required
accuracy of the energy is even greater than ${\cal O}(N^{5.5})$. This
clearly indicates the need to sophisticate the code
further. Nevertheless, these results also indicate that the code can
be applied to quite large systems. 
\newline


\begin{table}[hbtp]
\begin{center} {\large \bf Atomic Results} \\ 
$\phantom{a}$ \\
\begin{tabular}{ccccc}
\hline\\ 
{\bf Atom} & {\bf HF}     & {\bf VMC}   & {\bf 'Exact'} & {\bf \% CE} \\
He         &   -2.8617    &  -2.8865(1) &  -2.9037 & 59.0(2) \\   Li         &   -7.4327    &  -7.4599(2) &  -7.4781 & 59.9(4) \\   
Be         &  -14.5730    & -14.6072(4) & -14.6673 & 36.3(4) \\   
B          &  -24.5290    & -24.5679(4) & -24.6539 & 31.1(3) \\   
C          &  -37.6886    & -37.7307(3) & -37.8451 & 26.9(2) \\   
Ne         &  -128.547    & -128.595(4) & -128.937 & 12.1(10) \\   
Ar         &  -526.817    & -526.835(5) &  &  \\     [10pt]
\hline
\end{tabular} 
\end{center}
\caption{VMC results for a Roothaan HF Slater determinant,
  ref. \cite{clementi1974}, multiplied with a single parameter
  electron-electron Pad\'{e}-Jastrow factor, ref. \cite{hammond1994},
  for selected atoms. The results are compared with the Roothaan HF
  results, and the exact results, given by
  ref. \cite{hammond1994}. The results are obtained using the variance
  optimization scheme with weights equal to unity. The last column, 
  $\%$ CE, is the difference between the HF energies and the VMC
  energies relative to the difference between the HF and the exact
  results.}
\label{atomicResults}
\end{table}

Adding additional terms to the trial wave-function does not
significantly increase the time needed to obtain accurate results for
the energy, however parameter optimization becomes increasingly
important. Parallelizing the parameter optimization procedure
is both a natural and quite easy extension of the existing
code. Furthermore, including additional particle-particle correlations
requires optimization of more complex trial wave-functions. To reduce
the computational effort of such optimizations the accuracy of the VMC 
procedure needs improvement. In the next chapter we will study the
auto-correlation effects, and outline some further advances.


%********************* Auto-Correlation Effects *******************
%
%
\section{Auto-Correlation Effects}

Auto-correlation effects result in a reduced efficiency of the VMC
integration procedure. The theoretical development of these correlations
are described in section \ref{StatisticalAnalysis}, and we will here
make a more thorough investigation of these effects. As an example we
study the lithium ground state.
\newline

\begin{figure}[hbtp]
  \input{Results/twoElectronPlot}
  \caption{Plot of the electron-nucleus distances for the two
  like-spin electrons of ground state lithium. Both electrons are
  moved according to 
  the Metropolis algorithm, that samples the probability distribution
  of the trial wave-function which is a product of a Roothaan HF Slater
  determinant, ref. \cite{clementi1974}, multiplied with a single
  parameter electron-electron Pad\'{e}-Jastrow factor, 
  ref. \cite{hammond1994}.
  }
  \label{twoElectronPlot}
\end{figure}


The ground state of lithium has two electrons in the $1s$ orbital and
one electron in the $2s$ orbitals. The two electrons in $1s$ have
different spin projections due to the Pauli principle, and we choose the
third electron to have a positive spin value. In figure
\ref{twoElectronPlot} the electron-nucleus distances of the two
electrons with positive spin projections 
are plotted. There are several features regarding this plot that need
to be commented. First, the inter-electronic distances are strongly
correlated. This can be seen from the way the electrons need time to
evolve from one position to another, at least this is clearly seen for
the outermost electron. Second, the electron close to the
nucleus spans a shorter distance than the electron further
away. This is due to the different ranges of the $1s$ and $2s$
orbitals. A third effect is that the two electrons changes roles at
about 1850 MC cycles. 
\newline

\begin{figure}[hbp]
  \input{Results/electronDistanceLocalEnergy} 
  \input{Results/electronDistanceLocalEnergy20} 
  \caption{Plot of the electron-nucleus distances for the three
  electrons of ground state lithium, compared with the fluctuations in
  the local energy. All electrons are moved according to the
  Metropolis algorithm. The Metropolis algorithm 
  samples the probability distribution of a trial wave-function which
  is a product of a Roothaan HF Slater determinant,
  ref. \cite{clementi1974}, multiplied with a single parameter
  electron-electron Pad\'{e}-Jastrow factor, ref. \cite{hammond1994}.
  Two different time scales are shown.
  }
  \label{electronDistanceLocalEnergy}
\end{figure}

In figure \ref{electronDistanceLocalEnergy} a fourth effect becomes
apparent. The electron which is farthest away from the nucleus is
moved a short distance with almost each individual MC cycle, whereas
the two electrons close to the nucleus change positions only a few
times. These effects are manifested in the local energy
fluctuations. The variations of the electrons close to the nucleus
result in large changes in the local energy, while the changes in the
outlying electron only result in small changes.
\newline

\begin{figure}[htbp]
  \input{Results/acceptanceDistanceHistogram}
  \caption{Probability distribution as a function of acceptance ratios.
  The three electrons of Li are all undergoing the Metropolis
  algorithm. The acceptance ratios are averaged over blocks consisting 
  of 30 MC steps. }
  \label{acceptanceDistanceHistogram}
\end{figure}

In figure \ref{acceptanceDistanceHistogram} the Metropolis acceptance
ratios, averaged over approximately $11$ $000$ blocks each consisting
of $30$ MC cycles, are plotted for the three lithium ground state
electrons. What we see from this histogram is that the electron with
negative spin projection has an average acceptance ratio of about
$0.3$, whereas the two electrons with positive spin projections have
two distinct acceptance distributions; one normal distribution about
an acceptance-ratio $0.3$, and one distribution about $0.85$. This
result clearly demonstrates the inefficiency of the straightforward
Metropolis sampling of many-body wave-functions. The problem being
that the step lengths are equal for all electrons, whereas the
one-electron orbitals span different length-scales.
\newline
%
\newline
This problem increases with system size, and is one of the key
inefficiencies of the current program code. We have still not found
the solution to this problem in the literature, and solving this
particular problem remains important for further development. One
approach that may be investigated is to treat the step
lengths of the different electrons individually, requiring that all
electrons each have the same acceptance ratios. An
argument for allowing such a treatment is that since the
wave-function is anti-symmetric with respect to interchange of two
electrons, the probability distribution

\begin{equation*}
  \rho(\mathbf{X}) = \frac{|\Psi(\mathbf{X})|^2} 
      {\int\limits_{\Omega} |\Psi(\mathbf{X})|^2 d\Omega},
\end{equation*}

is symmetric. Therefore, all the permutations of $\mathbf{X} =\{
\mathbf{x}_1, \mathbf{x}_2, \dots, \mathbf{x}_N \}$ give the same
contribution to the expectation values of physical observables. By
this argument only one of the $N!$ subspaces, being perturbations of
$\rho(\mathbf{x}_1, \mathbf{x}_2, \dots, \mathbf{x}_N)$, needs to be
sampled. However, this approach needs a thorough investigation.
Nevertheless, the implications of such a scheme is that it would
significantly reduce auto-correlation effects. 
\newline
%
\newline
There are several other ways to reduce the statistical
auto-correlation present in the literature. Each step of the
Metropolis algorithm, implemented in this thesis, is proposed without
any knowledge of the wave-function. The proposed move of the walker
isotropic; it is equally likely to move in any direction. This
approach leads to a high 
rejection ratio. To reduce auto-correlation effects two criteria is
essential: (i) increase the acceptance and (ii) increase the step
length. The first criteria lessens the time it takes for the walker to
move from one point in the phase space to the other, and the second
criteria allow us to reach other parts of the configuration space more
rapidly. Increasing the step length in the above approach decreases
the acceptance, and vice versa. To obtain better efficiency the way we
choose our transition probabilities for the proposed moved needs to be
changed. Figure \ref{fokkerPlanck} illustrates the basic principles
behind such approaches. In these approaches the transition
probabilities of the walkers are modified so that it is more likely to
move to a region where $|\Psi|^2$ is large. To satisfy the requirement
of detailed balance the acceptance ratios must be modified
accordingly.
\newline

\begin{figure}[hbp]
  \input{Results/fokkerPlanck}
  \caption{Illustration of two different approaches for selecting the
  transition probabilities for the Metropolis algorithm. In the
  modified version we are more likely to move toward a region where
  the value of the wave-function is larger, than to a region where the
  wave-function is smaller.
  }
  \label{fokkerPlanck}
\end{figure}

One such approach is the Fokker-Planck formalism where we move the
walkers according to both diffusion and drift. The drift term is
dependent on the gradient of the wave-function, and is implemented
similar to the Diffusion Monte Carlo method. By this approach we
both obtain higher acceptance and can perform larger step length. For
details regarding the Fokker-Planck formalism consult for example
ref. \cite{hammond1994}. 



%*********************** Further Developments *********************
%
%
%\section{Future Developments}

%\begin{figure}[hbp]
%  \input{Results/electronDistanceLocalEnergyEvery300}
%  \caption{The fluctuations of the three electron-nucleus distances of
%  Li taken only at every 100 MC steps. The corresponding absolute value of the
%  local energy $|E_L|$ is also included; both electron-nucleus distances
%  and $|E_L|$ are in atomic units.
%  }
%  \label{electronDistanceLocalEnergyEvery300}
%\end{figure}

%\begin{figure}[htbp]
%  \input{Results/localEnergyHistogram}
%  \caption{The distribution of 100 000 MC samples of the local energy
%  $E_L$ compared to the normal distribution. }
%  \label{localEnergyHistogram}
%\end{figure}

%\begin{figure}[hp]
%  \input{Results/oneElectronPlot2}
%  \input{Results/oneElectronPlot1}
%  \input{Results/localEnergyPlot}
%  \caption{Plot of the electron-nucleus distances for the three
%  electrons of ground state lithium, compared with the fluctuations in
%  the local energy. All electrons undergo movement
%  specified by the Metropolis algorithm. The Metropolis algorithm
%  samples the probability distribution of a trial wave-function which
%  is a product of a Roothaan HF Slater determinant,
%  ref. \cite{clementi1974}, multiplied with a single parameter
%  electron-electron Pad\'{e}-Jastrow factor, ref. \cite{hammond1994}.
%  }
%  \label{localEnergyPlot}
%\end{figure}
%
