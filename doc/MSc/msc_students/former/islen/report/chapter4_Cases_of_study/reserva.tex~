\subsection{The hydrogen Atom}

These three coordinates yield in turn three quantum numbers which determine the
enegy of the systems.
We obtain three sets of ordinary second-order differential equations which can be
solved analytically, resulting
in
\be
   \frac{1}{F}\frac{\partial^2 F }{\partial \phi^2}=-C^2_{\phi},
\ee
\be
   C_rsin^2(\theta)P+sin(\theta)\frac{\partial }{\partial \theta}(sin(\theta)
     \frac{\partial P}{\partial \theta})=C_{\phi}^2P,
\ee
and
\be
\frac{1}{R}\frac{\partial }{\partial r}
          (r^2\frac{\partial R}{\partial r}) 
+\frac{2mrke^2}{\hbar^2}+\frac{2mr^2}{\hbar^2}E
=C_r,
\label{eq:radiell}
\ee
where $C_r$ and $C_{\phi}$ are constants. 
The angle-dependent differential equations result in the spherical harmonic
functions as
solutions, with quantum numbers $l$ and $m_l$.
These functions are given by
\be
    Y_{lm_l}(\theta,\phi)=P(\theta)F(\phi)=\sqrt{\frac{(2l+1)(l-m_l)!}{4\pi (l+m_l)!}}
                      P_l^{m_l}(cos(\theta))\exp{(im_l\phi)},
\ee
with $P_l^{m_l}$ being the associated Legendre polynomials
They can be rewritten as 
\be
   Y_{lm_l}(\theta,\phi)=sin^{|m_l|}(\theta) \times
(\mathrm{polynom}(cos\theta))\exp{(im_l\phi)},
\ee
with the following selected examples
\be
   Y_{00}=\sqrt{\frac{1}{4\pi}},
\ee
for $l=m_l=0$, 
\be
   Y_{10}=\sqrt{\frac{3}{4\pi}}cos(\theta),
\ee
for $l=1$ og $m_l=0$, 
\be
   Y_{1\pm 1}=\sqrt{\frac{3}{8\pi}}sin(\theta)exp(\pm i\phi),
\ee
for  $l=1$ og $m_l=\pm 1$, and 
\be
   Y_{20}=\sqrt{\frac{5}{16\pi}}(3cos^2(\theta)-1)
\ee
for $l=2$ og $m_l=0$. 
The quantum numbers $l$ and $m_l$ represent the orbital momentum and projection of
the orbital momentum, respectively and take 
the values
\begin{enumerate}\item  \[ l \ge 0\]
\item \[ l=0,1,2,\dots \]
\item \[ m_l=-l,-l+1,\dots, l-1,l \]
\end{enumerate}
The spherical harmonics for $l \le 3$ are listed in Table
\ref{tab:sphericalHaromical}.
\begin{table}[hbtp]
\begin{center} {\large \bf Spherical Harmonics} \\ 
$\phantom{a}$ \\
\begin{tabular}{ccccc}
\hline\\ 
$m_l\backslash l$ & \phantom{AA}0\phantom{AA}
& \phantom{AA}1\phantom{AA} & \phantom{AA}2\phantom{AA} &
\phantom{AA}3\phantom{AA} \\ 
\hline\\ 
+3 &                      &
&
&$-\frac{1}{8}(\frac{35}{\pi})^{1/2}sin^3\theta e^{+ 3i\phi}$
\\ [7pt] 

+2 &                      &
&$\frac{1}{4}(\frac{15}{2\pi})^{1/2}sin^2\theta e^{+ 2i\phi}$
&$\frac{1}{4}(\frac{105}{2\pi})^{1/2}cos\theta sin^2\theta e^{+ 2i\phi}$     \\ [7pt]

+1 &  
&$-\frac{1}{2}(\frac{3}{2\pi})^{1/2}sin\theta
e^{+i\phi}$&$-\frac{1}{2}(\frac{15}{2\pi})^{1/2}cos\theta sin\theta
e^{+ i\phi}$&$-\frac{1}{8}(\frac{21}{2\pi})^{1/2}(5cos^2\theta
-1)sin\theta e^{+ i\phi}$\\ [7pt] 

 0 &$\frac{1}{2\pi^{1/2}}$&$\frac{1}{2}(\frac{3}{\pi})^{1/2}cos\theta$
 &$\frac{1}{4}(\frac{5}{\pi})^{1/2}(3cos^2\theta-1)$
 &$\frac{1}{4}(\frac{7}{\pi})^{1/2}(2-5sin^2\theta)cos\theta$
 \\ [7pt] 

-1 &  
 &$+\frac{1}{2}(\frac{3}{2\pi})^{1/2}sin\theta
 e^{-i\phi}$&$+\frac{1}{2}(\frac{15}{2\pi})^{1/2}cos\theta sin\theta
 e^{- i\phi}$&$+\frac{1}{8}(\frac{21}{2\pi})^{1/2}(5cos^2\theta
 -1)sin\theta e^{- i\phi}$\\ [7pt] 

-2 &                      &
 &$\frac{1}{4}(\frac{15}{2\pi})^{1/2}sin^2\theta e^{- 2i\phi}$
 &$\frac{1}{4}(\frac{105}{2\pi})^{1/2}cos\theta sin^2\theta e^{- 2i\phi}$     \\ [7pt]

-3 &                      &
&
&$+\frac{1}{8}(\frac{35}{\pi})^{1/2}sin^3\theta e^{- 3i\phi}$
\\ [7pt] 
\hline
\end{tabular} 
\end{center}
\caption{Spherical harmonics $Y_{lm_l}$ for the lowest $l$ and $m_l$
  values.} 
\label{tab:sphericalHaromical}
\end{table}


We concentrate on the radial equation, which can be rewritten as 
\be
-\frac{\hbar^2 r^2}{2m}\left(\frac{\partial }{\partial r}
          (r^2\frac{\partial R(r)}{\partial r})\right) 
-\frac{ke^2}{r}R(r)+\frac{\hbar^2l(l+1)}{2mr^2}R(r)=ER(r).
\ee
Introducing the function $u(r)=rR(r)$, we can rewrite the last equation as






For the hydrogen atom, we could perform the variational calculation 
along the same lines as we did for the harmonic oscillator.
The only difference is that       
Eq.~(\ref{eq:vmc1}) now reads
\be
  \langle H \rangle =\int P({\bf R})E_L({\bf R}) d{\bf R}=
  \int_0^{\infty}\alpha^2\rho^2 e^{-2\alpha\rho}E_L(\rho)\rho^2d\rho,
\ee
since $\rho\in [0, \infty ]$. In this case we would use the exponential
distribution instead of the normal distrubution, and our code would contain
the following elements
\begin{lstlisting}
...  initialisations, declarations of variables
...  mcs = number of  Monte Carlo samplings
     
//   loop over Monte Carlo samples
     for ( i=0; i < mcs; i++) {

//   generate random variables from the exponential 
//   distribution using ran1 and transforming to
//   to an exponential mapping y = -ln(1-x)
         x=ran1(&idum);
         y=-log(1.-x);
//   in our case y = rho*alpha*2
         rho = y/alpha/2;
         local_energy = -1/rho -0.5*alpha*(alpha-2/rho);
         energy += (local_energy);
         energy2 += local_energy*local_energy;
//   end of sampling
     }
//   write out the mean energy and the standard deviation
     cout << energy/mcs << sqrt((energy2/mcs-(energy/mcs)**2)/mcs));
\end{lstlisting}
As for the harmonic oscillator case we just need to generate a large
number $N$ of random numbers corresponding to the exponential PDF
$\alpha^2\rho^2 e^{-2\alpha\rho}$ and for each random number we compute the 
local energy and variance.

\subsection{Metropolis sampling for the hydrogen atom and the harmonic oscillator}
We present in this subsection results for the ground states
of the hydrogen atom and harmonic oscillator using a variational 
Monte Carlo procedure. For the hydrogen atom, the trial wave function 
\[
     u_T^{\alpha}(\rho)=\alpha\rho e^{-\alpha\rho},
\]
depends only on the dimensionless radius $\rho$. It is the solution
of a one-dimensional differential equation, as is the case
for the harmonic oscillator as well. The latter has the trial
wave function 
\[
\Psi_T(x)=\frac{\sqrt{\alpha}}{\pi^{1/4}}e^{-x^2\alpha^2/2}.
\]
However, for the hydrogen atom we have $\rho\in [0,\infty]$, while
for the harmonic oscillator we have $x\in [-\infty, \infty]$.

This has important consequences for the way we generate random positions.
For the hydrogen atom we have a random position given by e.g.,
\begin{verbatim}
  r_old = step_length*(ran1(&idum))/alpha; 
\end{verbatim} 
which ensures that $\rho \ge 0$, while for the harmonic oscillator we
have 
\begin{verbatim}
  r_old = step_length*(ran1(&idum)-0.5)/alpha; 
\end{verbatim} 
in order to have $x\in [-\infty, \infty]$. This is however not implemented 
in the program below. There, importance sampling is not included. We simulate
points in the $x$, $y$ and $z$ directions using random numbers generated
by the uniform distribution and multiplied by the step length. 
Note that we have to define a step length in our calculations. 
Here one has to play around with different values 
for the step and as a rule of thumb
(one of the golden Monte Carlo rules), the step length should be chosen
so that roughly 50\% of all new moves are accepted.
In the program at the end of this section 
we have also scaled the random position 
with the variational parameter $\alpha$. The reason for this particular choice
is that we have an external loop over the variational
parameter. Different variational parameters will obviously yield different
acceptance rates if we use the same step length. An alternative to the code
below is to perform the Monte Carlo sampling with just one variational
parameter, and play around with different step lengths in order
to achieve a reasonable acceptance ratio. Another possibility is
to include a more advanced test which restarts the Monte Carlo sampling
with a new step length if the specific 
variational parameter and chosen step length lead to a too low acceptance
ratio.

\begin{figure}
\begin{center}
%\input{hovmc}
\end{center}
\caption{Result  for ground state energy of the harmonic oscillator as
         function of the variational parameter $\alpha$. The exact result
         is for $\alpha=1$ with an energy $E=1$. 
         See text for further details\label{fig:hovmc}}
\end{figure}
In Figs.~\ref{fig:hovmc} and \ref{fig:hydrogenvmc} we plot the ground state
energies  for
the one-dimensional harmonic oscillator and the hydrogen atom, respectively,
as functions of the variational parameter $\alpha$. 
These results are also displayed in Tables \ref{tab:tabhovmc} and
\ref{tab:tabhydrogenvmc}. In these tables we list the variance and
the standard deviation as well. We note that at $\alpha$ we obtain the exact
result, and the variance is zero, as it should. The reason is that 
we then have the exact wave function, and the action of the hamiltionan
on the wave function
\[
   H\psi = \mathrm{constant}\times \psi,
\]
yields just a constant. The integral which defines various 
expectation values involving moments of the hamiltonian becomes then
\be
   \langle H^n \rangle =
   \frac{\int d{\bf R}\Psi^{\ast}_T({\bf R})H^n({\bf R})\Psi_T({\bf R})}
        {\int d{\bf R}\Psi^{\ast}_T({\bf R})\Psi_T({\bf R})}=
\mathrm{constant}\times\frac{\int d{\bf R}\Psi^{\ast}_T({\bf R})\Psi_T({\bf R})}
        {\int d{\bf R}\Psi^{\ast}_T({\bf R})\Psi_T({\bf R})}=
\mathrm{constant}.
\ee
\begin{table}[hbtp]
\begin{center}
\caption{Result  for ground state energy of the harmonic oscillator as
         function of the variational parameter $\alpha$. The exact result
         is for $\alpha=1$ with an energy $E=1$. The energy 
         variance $\sigma^2$ and the standard deviation $\sigma/\sqrt{N}$ 
         are also listed. The variable $N$ is the number of Monte Carlo
         samples. In this calculation we set $N=100000$ and a step length of 
         2 was used in order to obtain an acceptance of $\approx 50\%$.
         \label{tab:tabhovmc}}
\begin{tabular}{rrrr}\hline
$\alpha$&$\langle H \rangle $&$\sigma^2$&$\sigma/\sqrt{N}$ \\\hline
 5.00000E-01 &  2.06479E+00 &  5.78739E+00 &  7.60749E-03 \\ 
 6.00000E-01 &  1.50495E+00 &  2.32782E+00 &  4.82475E-03 \\ 
 7.00000E-01 &  1.23264E+00 &  9.82479E-01 &  3.13445E-03 \\ 
 8.00000E-01 &  1.08007E+00 &  3.44857E-01 &  1.85703E-03 \\ 
 9.00000E-01 &  1.01111E+00 &  7.24827E-02 &  8.51368E-04 \\ 
 1.00000E-00 &  1.00000E+00 &  0.00000E+00 &  0.00000E+00 \\ 
 1.10000E+00 &  1.02621E+00 &  5.95716E-02 &  7.71826E-04 \\ 
 1.20000E+00 &  1.08667E+00 &  2.23389E-01 &  1.49462E-03 \\ 
 1.30000E+00 &  1.17168E+00 &  4.78446E-01 &  2.18734E-03 \\ 
 1.40000E+00 &  1.26374E+00 &  8.55524E-01 &  2.92493E-03 \\ 
 1.50000E+00 &  1.38897E+00 &  1.30720E+00 &  3.61553E-03 \\ \hline
\end{tabular}
\end{center}
\end{table}
\begin{figure}
\begin{center}
%\input{hydrogenvmc}
\end{center}
\caption{Result  for ground state energy of the hydrogen atom as
         function of the variational parameter $\alpha$. The exact result
         is for $\alpha=1$ with an energy $E=-1/2$. 
         See text for further details\label{fig:hydrogenvmc}}
\end{figure}
This explains why the variance is zero for $\alpha=1$. 
However, the hydrogen atom and the harmonic oscillator are
some of the few cases where we can use a trial wave function proportional
to the exact one. These two systems are also some of the few examples 
of cases where we can find an exact solution to the problem.
\begin{table}[hbtp]
\begin{center}
\caption{Result  for ground state energy of the hydrogen atom as
         function of the variational parameter $\alpha$. The exact result
         is for $\alpha=1$ with an energy $E=-1/2$. The energy 
         variance $\sigma^2$ and the standard deviation $\sigma/\sqrt{N}$ 
         are also listed. The variable $N$ is the number of Monte Carlo
         samples. In this calculation we fixed $N=100000$ and a step length of 
         4 Bohr radii  
         was used in order to obtain an acceptance of $\approx 50\%$.
         \label{tab:tabhydrogenvmc}}
\begin{tabular}{rrrr}\hline
$\alpha$&$\langle H \rangle $&$\sigma^2$&$\sigma/\sqrt{N}$ \\\hline
 5.00000E-01 & -3.76740E-01 &  6.10503E-02 &  7.81347E-04 \\ 
 6.00000E-01 & -4.21744E-01 &  5.22322E-02 &  7.22718E-04 \\ 
 7.00000E-01 & -4.57759E-01 &  4.51201E-02 &  6.71715E-04 \\ 
 8.00000E-01 & -4.81461E-01 &  3.05736E-02 &  5.52934E-04 \\ 
 9.00000E-01 & -4.95899E-01 &  8.20497E-03 &  2.86443E-04 \\ 
 1.00000E-00 & -5.00000E-01 &  0.00000E+00 &  0.00000E+00 \\ 
 1.10000E+00 & -4.93738E-01 &  1.16989E-02 &  3.42036E-04 \\ 
 1.20000E+00 & -4.75563E-01 &  8.85899E-02 &  9.41222E-04 \\ 
 1.30000E+00 & -4.54341E-01 &  1.45171E-01 &  1.20487E-03 \\ 
 1.40000E+00 & -4.13220E-01 &  3.14113E-01 &  1.77232E-03 \\ 
 1.50000E+00 & -3.72241E-01 &  5.45568E-01 &  2.33574E-03 \\ \hline
\end{tabular}
\end{center}
\end{table}
In most cases of interest, we do not know a priori the exact wave function,
or how to make a good trial wave function. 
In essentially all real problems a large amount of CPU time 
and numerical experimenting is needed in order to ascertain the 
validity of a Monte Carlo estimate. 
The next examples 
deal with such problems.

% % % % % % % % % % $$\Psi_T(\bfv{r_1}, \bfv{r_2}) = e^{-\alpha(r_1 + r_2)}$$
% % % % % % % % % % 
% % % % % % % % % % where $r_k = \sqrt {x_{k}^2 + y_{k}^2 + z_{k}^2}$
% % % % % % % % % % 
% % % % % % % % % % 
% % % % % % % % % % 
% % % % % % % % % % The hamiltonian becomes then
% % % % % % % % % % \be
% % % % % % % % % %    \Op{H}=-\frac{\hbar^2\nabla_1^2}{2m}-\frac{\hbar^2\nabla_2^2}{2m}
% % % % % % % % % %           -\frac{2ke^2}{r_1}-\frac{2ke^2}{r_2}+
% % % % % % % % % %                \frac{ke^2}{r_{12}},
% % % % % % % % % % \ee
% % % % % % % % % % and  Schr\"odingers equation reads
% % % % % % % % % % \be
% % % % % % % % % %    \Op{H}\psi=E\psi.
% % % % % % % % % % \ee
% % % % % % % % % % Note that this equation has been written in atomic units $a.u.$ 
% % % % % % % % % % which are more convenient for quantum mechanical problems.
% % % % % % % % % % This means that the final energy has to be multiplied by a $2\times E_0$,
% % % % % % % % % % where $E_0=13.6$ eV, the binding energy of the hydrogen atom. 
% % % % % % % % % % 
% % % % % % % % % % A very simple first approximation to this system is to omit
% % % % % % % % % % the repulsion between the two electrons. The potential energy becomes
% % % % % % % % % % then
% % % % % % % % % % \be
% % % % % % % % % %     V(r_1, r_2)\approx -\frac{Zke^2}{r_1}-
% % % % % % % % % %                       \frac{Zke^2}{r_2}.
% % % % % % % % % % \ee
% % % % % % % % % % The advantage of this approximation is that each electron can be 
% % % % % % % % % % treated as being independent of each other, implying that
% % % % % % % % % % each electron sees just a centrally symmetric potential, or central
% % % % % % % % % % field.
% % % % % % % % % % 
% % % % % % % % % % To see whether this gives a meaningful result, we set 
% % % % % % % % % % $Z=2$ and neglect totally the repulsion between the two electrons.
% % % % % % % % % % Electron 1 has the following hamiltonian
% % % % % % % % % % \be
% % % % % % % % % %    \Op{h}_1=-\frac{\hbar^2\nabla_1^2}{2m}
% % % % % % % % % %           -\frac{2ke^2}{r_1},
% % % % % % % % % % \ee
% % % % % % % % % % with pertinent  wave function and eigenvalue
% % % % % % % % % % \be
% % % % % % % % % %    \Op{h}_1\psi_a=E_a\psi_a,
% % % % % % % % % % \ee
% % % % % % % % % % where $a=\{ n_al_am_{l_a}\}$, are its quantum numbers.
% % % % % % % % % % The energy $E_a$ is
% % % % % % % % % % \be
% % % % % % % % % %    E_a=-\frac{Z^2E_0}{n_a^2},
% % % % % % % % % % \ee
% % % % % % % % % % med $E_0=13.6$ eV, being the ground state energy of the hydrogen atom.
% % % % % % % % % % In a similar way, we obatin for electron 2
% % % % % % % % % % \be
% % % % % % % % % %    \Op{h}_2=-\frac{\hbar^2\nabla_2^2}{2m}
% % % % % % % % % %           -\frac{2ke^2}{r_2},
% % % % % % % % % % \ee
% % % % % % % % % % with wave function
% % % % % % % % % % \be
% % % % % % % % % %    \Op{h}_2\psi_b=E_b\psi_b,
% % % % % % % % % % \ee
% % % % % % % % % % and  $b=\{ n_bl_bm_{l_b}\}$, and energy 
% % % % % % % % % % \be
% % % % % % % % % %    E_b=\frac{Z^2E_0}{n_b^2}.
% % % % % % % % % % \ee
% % % % % % % % % % Since the electrons do not interact, we can assume that the 
% % % % % % % % % % ground state wave function of the helium atom is given by
% % % % % % % % % % \be
% % % % % % % % % %   \psi=\psi_a\psi_b,
% % % % % % % % % % \ee
% % % % % % % % % % resulting in the following approximation to Schr\"odinger's equation
% % % % % % % % % % \be
% % % % % % % % % %    \left(\Op{h}_1+\Op{h}_2\right)\psi=
% % % % % % % % % %     \left(\Op{h}_1+\Op{h}_2\right)
% % % % % % % % % %     \psi_a({\bf r}_1)\psi_b({\bf r}_2)=
% % % % % % % % % %     E_{ab}\psi_a({\bf r}_1)\psi_b({\bf r}_2).
% % % % % % % % % % \ee
% % % % % % % % % % The energy becomes then
% % % % % % % % % % \be
% % % % % % % % % %     \left(\Op{h}_1\psi_a({\bf r}_1)\right)\psi_b({\bf r}_2) +
% % % % % % % % % %     \left(\Op{h}_2\psi_b({\bf r}_2)\right)\psi_a({\bf r}_1) =
% % % % % % % % % %     \left(E_{a}+E_b\right)\psi_a({\bf r}_1)\psi_b({\bf r}_2),
% % % % % % % % % % \ee
% % % % % % % % % % yielding
% % % % % % % % % % \be
% % % % % % % % % %    E_{ab}=Z^2E_0\left(\frac{1}{n_a^2}+\frac{1}{n_b^2}\right).
% % % % % % % % % % \ee
% % % % % % % % % % If we insert $Z=2$ and assume that the ground state is determined
% % % % % % % % % % by two electrons in the lowest-lying hydrogen orbit
% % % % % % % % % % with $n_a=n_b=1$, the energy becomes
% % % % % % % % % % \be
% % % % % % % % % %     E_{ab}=8E_0=-108.8\hspace{0.1cm} \mathrm{eV},
% % % % % % % % % % \ee
% % % % % % % % % % while the experimental value is 
% % % % % % % % % % $-78.8$ eV. Clearly, this discrepancy is essentially due to
% % % % % % % % % % our omission of the repulsion arising from the interaction of
% % % % % % % % % % two electrons. 




% % % % % % % % % % For most hamiltonians, $\Op{H}$ is a sum of kinetic energy, involving a second derivative, and spatial dependent potential. The contribution from the potential term is hence just the numerical value of the potential. A typical Hamiltonian reads thus
% % % % % % % % % % \begin{equation}
% % % % % % % % % %   \Op{H} = - \frac {\hbar^2}{2m} \sum_{i=1}^N \nabla_i^2 + \sum_{i=1}^N
% % % % % % % % % % V_{\mathrm{onebody}}({\bf r}_i) 
% % % % % % % % % %   + \sum_{i<j}^N V_{\mathrm{int}}(\mid{\bf r}_i -{\bf r}_j \mid ). 
% % % % % % % % % % \end{equation}
% % % % % % % % % % where the sum runs over all particles $N$. We have included both a onebody potential 
% % % % % % % % % % $V_{\mathrm{onebody}}({\bf r}_i)$ which acts on one particle at the time and a twobody
% % % % % % % % % % interaction $V_{\mathrm{int}}(\mid{\bf r}_i -{\bf r}_j \mid )$ which acts between
% % % % % % % % % % two particles
% % % % % % % % % % at the time. We can obviously extend this to more complicated three-body and/or
% % % % % % % % % % many-body forces as well.
% % % % % % % % % % The main contributions to the energy of physical systems is largely dominated by
% % % % % % % % % % one- and two-body
% % % % % % % % % % forces. We will therefore limit our attention to such interactions only.
% % % % % % % % % % 
% % % % % % % % % % Our local energy operator becomes then 
% % % % % % % % % % \be
% % % % % % % % % %    \Op{E}_L({\bf R};\alpha)=\frac{1}{\psi_T({\bf R};\alpha)}\left(- \frac
% % % % % % % % % % {\hbar^2}{2m} \sum_{i=1}^N \nabla_i^2+ \sum_{i=1}^N 
% % % % % % % % % % V_{\mathrm{onebody}}({\bf r}_i) + \sum_{i<j}^N V_{\mathrm{int}}(\mid{\bf r}_i -{\bf
% % % % % % % % % % r}_j \mid )\right)\psi_T({\bf R};\alpha),
% % % % % % % % % % \ee
% % % % % % % % % % resulting in
% % % % % % % % % % \be
% % % % % % % % % %    \Op{E}_L({\bf R};\alpha)=\frac{1}{\psi_T({\bf R};\alpha)}\left(- \frac
% % % % % % % % % % {\hbar^2}{2m} \sum_{i=1}^N \nabla_i^2\right)\psi_T({\bf R};\alpha) 
% % % % % % % % % %   + \sum_{i=1}^N V_{\mathrm{onebody}}({\bf r}_i) + \sum_{i<j}^N
% % % % % % % % % % V_{\mathrm{int}}(\mid{\bf r}_i -{\bf r}_j \mid ),
% % % % % % % % % % \ee



% % % % % % % In this example we will make life simple and choose
% % % % % % % $m=\hbar=k=1$. 
% % % % % % % We can rewrite the above  equation as 
% % % % % % % \be
% % % % % % %    H=-\frac{d^2}{dx^2}+x^2,
% % % % % % % \ee
% % % % % % % 
% % % % % % % The energy of the ground state is then
% % % % % % % $E_0=1$. The exact wave function for the ground state is 
% % % % % % % \be
% % % % % % % \Psi_0(x)=\frac{1}{\pi^{1/4}}e^{-x^2/2},
% % % % % % % \ee
% % % % % % % but since we wish to illustrate the use of Monte Carlo 
% % % % % % % methods, we choose 
% % % % % % % the trial function
% % % % % % % \be
% % % % % % % \Psi_T(x)=\frac{\sqrt{\alpha}}{\pi^{1/4}}e^{-x^2\alpha^2/2}.
% % % % % % %   \label{eq:trialho}
% % % % % % % \ee
% % % % % % % Inserting this function in the expression for the local energy
% % % % % % % in Eq.~(\ref{eq:locale1}), 
% % % % % % % we obtain the following expression for the local energy
% % % % % % % \be
% % % % % % %   E_L(x)=\alpha^2+x^2(1-\alpha^4),
% % % % % % %   \label{eq:localho}
% % % % % % % \ee 
% % % % % % % with the expectation value for the hamiltonian of Eq.~(\ref{eq:vmc1}) 
% % % % % % % given by
% % % % % % % \be
% % % % % % %    \langle E_L\rangle=\int_{-\infty}^{\infty}\left|\psi_T(x)\right|^2E_L(x)dx,
% % % % % % % \ee
% % % % % % % which reads with the above trial wave function
% % % % % % % \be
% % % % % % %    \langle E_L\rangle=
% % % % % % %    \frac{\int_{-\infty}^{\infty}dxe^{-x^2\alpha^2}\alpha^2+x^2(1-\alpha^4)}
% % % % % % % {\int_{-\infty}^{\infty}dxe^{-x^2\alpha^2}}.
% % % % % % % \ee
% % % % % % % Using the fact that
% % % % % % % \[
% % % % % % %    \int_{-\infty}^{\infty}dxe^{-x^2\alpha^2}=\sqrt{\frac{\pi}{\alpha^2}},
% % % % % % % \]
% % % % % % % we obtain
% % % % % % % \be
% % % % % % %    \langle E_L \rangle=\frac{\alpha^2}{2}+\frac{1}{2\alpha^2}.
% % % % % % % \ee
% % % % % % % and the variance 
% % % % % % % \be
% % % % % % %   \sigma^2=\frac{(\alpha^4-1)^2}{2\alpha^4}.
% % % % % % %   \label{eq:hovariance1}
% % % % % % % \ee
% % % % % % % 
% % % % % % % 
% % % % % % % 
% % % % % % % 
% % % % % % % 
% % % % % % % In a certain sense, this is nothing but the importance Monte Carlo
% % % % % % % sampling discussed in chapter \ref{chap:mcint}
% % % % % % % Before we proceed however, there is an important aside which 
% % % % % % % is worth keeping in mind when computing the local energy.
% % % % % % % We could think of splitting the computation of the expectation
% % % % % % % value of the local energy into a kinetic energy part and a potential
% % % % % % % energy part. If we are dealing with a three-dimensional system,
% % % % % % % the expectation value of the kinetic energy is
% % % % % % % \be
% % % % % % %    -\frac{\int d{\bf R}\Psi^{\ast}_T({\bf R})\nabla^2\Psi_T({\bf R})}
% % % % % % %         {\int d{\bf R}\Psi^{\ast}_T({\bf R})\Psi_T({\bf R})},
% % % % % % % \ee    
% % % % % % % and we could be tempted to compute, if the wave function obeys spherical
% % % % % % % symmetry, just the second derivative with respect to one coordinate
% % % % % % % axis and then multiply by three. This will most likely increase the 
% % % % % % % variance, and should be avoided, even if the final expectation
% % % % % % % values are similar. Recall that one of the subgoals of a Monte Carlo
% % % % % % % computation is to decrease the variance.



% % % % % % % % % % \scriptsize
% % % % % % % % % % \begin{tabular}{l*{4}{l}l}
% % % % % % % % % % \toprule
% % % % % % % % % % Function              & Equation & Gradient & Laplacian \\
% % % % % % % % % % \midrule
% % % % % % % % % % $\phi_{1s}(\bfv{r})$  &  $e^{-\alpha r}$ &  & \\
% % % % % % % % % % $\phi_{2s}(\bfv{r})$  & $\left(1 - \frac{\alpha}{2} r\right)e^{-\frac{\alpha}{2} r}$ &  & \\
% % % % % % % % % % \bottomrule
% % % % % % % % % % \end{tabular}
% % % % % % % % % % \normalsize


% % % % % % % % % % % % % \scriptsize
% % % % % % % % % % % % % \begin{tabular}{l*{4}{l}l}
% % % % % % % % % % % % % \toprule
% % % % % % % % % % % % % Function              & Equation & Gradient & Laplacian \\
% % % % % % % % % % % % % \midrule
% % % % % % % % % % % % % Pad\'e 	      & $\Psi_{C} = e^{{\sum\limits_{j<i} \frac{a r_{ij}}{(1 + b r_{ij})}}}$   & $\bfv{\nabla} \Psi_C = \Psi_C e^{{\sum\limits_{j<i} \frac{\bfv{r}_{ij}}{{r}_{ij}}\frac{a r_{ij}}{(1 + b r_{ij})^2}}}$ & $\nabla^2 = \Psi_{C}e^{\sum\limits{j<i} \frac{a(2r_{ij}^{-1}(1+br_{ij}) + a)}{(1+br_{ij})^4}}$ \\
% % % % % % % % % % % % % \bottomrule
% % % % % % % % % % % % % \end{tabular}
% % % % % % % % % % % % % \normalsize
% % % % % % % % % % % % % 
% % % % % % % % % % % % % 

derivacion de expresiones analyticas

% % % % % % $$
% % % % % %  \Grad{\phi_{1s}} = \frac{\partial \phi_{1s}}{\partial r} \left(\frac{\partial r}{\partial x}\uvec{e}_1 + \frac{\partial r}{\partial y}\uvec{e}_2 + \frac{\partial r}{\partial z}\uvec{e}_3 \right)$$
% % % % % % or 
% % % % % % % Later,
% % % % % % % 
% % % % % % % \begin{eqnarray}
% % % % % % %  \Grad{\phi_{2s}} & = & \frac{\partial \phi_{2s}}{\partial r} \left(\frac{\partial r}{\partial x}\uvec{e}_1 + \frac{\partial r}{\partial y}\uvec{e}_2 + \frac{\partial r}{\partial z}\uvec{e}_3 \right)\nonumber\\
% % % % % % % & = & \frac{\partial \phi_{2s}}{\partial r}  \left(\frac{x}{r}\uvec{e}_1 + \frac{y}{r}\uvec{e}_2 + \frac{z}{r}\uvec{e}_3 \right)\nonumber
% % % % % % % \end{eqnarray}
% % % % % % % 
% % % % % % % Now, 
% % % % % % % \begin{eqnarray}
% % % % % % % \frac{\partial \phi_{2s}}{\partial r} & = & -\frac{\alpha}{2} e^{-\frac{\alpha}{2}r} - \frac{\alpha}{2}\left(e^{-\frac{\alpha}{2}r} -\frac{\alpha}{2} r e^{-\frac{\alpha}{2}r} \right)\nonumber\\
% % % % % % % & = & -\frac{\alpha}{2}\left(2 - \frac{\alpha}{2} r\right) e^{-\frac{\alpha}{2}r}\nonumber
% % % % % % % \end{eqnarray}
% % % % % % % 
% % % % % % % Hence, 
% % % % % % % 
% % % % % % % \begin{equation}
% % % % % % %  \boxed{\Grad{\phi_{2s}} = -\frac{\alpha}{2}\left(2 - \frac{\alpha}{2} r\right)\left(\frac{x}{r}\uvec{e}_1 + \frac{y}{r}\uvec{e}_2 + \frac{z}{r}\uvec{e}_3 \right)e^{-\frac{\alpha}{2}r}}
% % % % % % % \end{equation}

% % % % % % % % % % % % % \begin{eqnarray*}
% % % % % % % % % % % % % \nabla^2 \phi_{1s} & = & \bfv{\nabla} \bullet \Grad{\phi_{1s}}\\
% % % % % % % % % % % % % & = & \left(\frac{\partial }{\partial x}\uvec{e}_1 + \frac{\partial }{\partial y}\uvec{e}_2 + \frac{\partial }{\partial z}\uvec{e}_3 \right) \bullet \left[-\alpha \left(\frac{x}{r}\uvec{e}_1 + \frac{y}{r}\uvec{e}_2 + \frac{z}{r}\uvec{e}_3 \right) e^{-\alpha r}\right]\nonumber\\
% % % % % % % % % % % % % & = & -\alpha \left[\frac{\partial }{\partial x}\left(\frac{x}{r} e^{-\alpha r}\right) + \frac{\partial }{\partial y} \left(\frac{y}{r} e^{-\alpha r}\right) + \frac{\partial }{\partial z}\left( \frac{x}{r} e^{-\alpha r}\right) \right]\nonumber\\
% % % % % % % % % % % % % & = & -\alpha \frac{\left(e^{-\alpha r} - \alpha \frac{x^2}{r} e^{-\alpha r}\right) r - \frac{x^2}{r} e^{-\alpha r}}{r^2} -\alpha \frac{\left(e^{-\alpha r} - \alpha \frac{y^2}{r} e^{-\alpha r}\right) r - \frac{y^2}{r} e^{-\alpha r}}{r^2}\\
% % % % % % % % % % % % % & & -\alpha \frac{\left(e^{-\alpha r} - \alpha \frac{z^2}{r} e^{-\alpha r}\right) r - \frac{z^2}{r} e^{-\alpha r}}{r^2} \\
% % % % % % % % % % % % % & = & -\alpha\left[\left(\frac{1}{r} - \alpha \frac{x^2}{r^2} - \frac{x^2}{r^3} \right) + \left(\frac{1}{r} - \alpha \frac{y^2}{r^2} - \frac{y^2}{r^3} \right) + \left(\frac{1}{r} - \alpha \frac{z^2}{r^2} - \frac{z^2}{r^3} \right) \right] e^{-\alpha r}
% % % % % % % % % % % % % \end{eqnarray*}
% % % % % % % % % % % % % 
% % % % % % % % % % % % % or 