      SUBROUTINE E01ACF(A, B, X, Y, F, VAL, VALL, IFAIL, XX, WORK,W, D,
     * IG1, M1,	N1)
C     MARK 1 RELEASE.  NAG COPYRIGHT 1971
C     MARK 3 REVISED.
C     MARK 4.5 REVISED
      INTEGER P01AAF, ISAVE, IFAIL, N1,	M1, M, N, J, I,	IG1
C$P 1
      DOUBLE PRECISION SRNAME
      DOUBLE PRECISION A, B, VAL, VALL,	E01ACZ,	X(N1), Y(M1), F(N1,M1),
     *XX(IG1), WORK(IG1), W(IG1), D(IG1)
      DATA SRNAME /8H E01ACF /
      ISAVE = IFAIL
      IF ((A.LT.X(1)) .OR. (A.GT.X(N1))) GO TO 100
      IF ((B.LT.Y(1)) .OR. (B.GT.Y(M1))) GO TO 100
      IFAIL = 0
      M	= M1 - 1
      N	= N1 - 1
      DO 40 J=1,M1
	 DO 20 I=1,N1
	    WORK(I) = F(I,J)
   20	 CONTINUE
	 CALL E01ACY(N1, X, WORK, W, D,	IG1)
	 XX(J) = E01ACZ(N1,X,WORK,W,A,IG1)
   40 CONTINUE
      CALL E01ACY(M1, Y, XX, W,	D, IG1)
      VAL = E01ACZ(M1,Y,XX,W,B,IG1)
      DO 80 I=1,N1
	 DO 60 J=1,M1
	    WORK(J) = F(I,J)
   60	 CONTINUE
	 CALL E01ACY(M1, Y, WORK, W, D,	IG1)
	 XX(I) = E01ACZ(M1,Y,WORK,W,B,IG1)
   80 CONTINUE
      CALL E01ACY(N1, X, XX, W,	D, IG1)
      VALL = E01ACZ(N1,X,XX,W,A,IG1)
      GO TO 120
  100 IFAIL = P01AAF(ISAVE,1,SRNAME)
  120 RETURN
      END
